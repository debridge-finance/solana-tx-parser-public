import{PublicKey as t,TransactionInstruction as e,SystemProgram as n,Transaction as r,SystemInstruction as o}from"@solana/web3.js";import{utils as i,BN as s,BorshInstructionCoder as a}from"@project-serum/anchor";for(var u={},c={byteLength:function(t){var e=y(t),n=e[0],r=e[1];return 3*(n+r)/4-r},toByteArray:function(t){var e,n,r=y(t),o=r[0],i=r[1],s=new d(function(t,e,n){return 3*(e+n)/4-n}(0,o,i)),a=0,u=i>0?o-4:o;for(n=0;n<u;n+=4)e=h[t.charCodeAt(n)]<<18|h[t.charCodeAt(n+1)]<<12|h[t.charCodeAt(n+2)]<<6|h[t.charCodeAt(n+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===i&&(e=h[t.charCodeAt(n)]<<2|h[t.charCodeAt(n+1)]>>4,s[a++]=255&e);1===i&&(e=h[t.charCodeAt(n)]<<10|h[t.charCodeAt(n+1)]<<4|h[t.charCodeAt(n+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},fromByteArray:function(t){for(var e,n=t.length,r=n%3,o=[],i=16383,s=0,a=n-r;s<a;s+=i)o.push(m(t,s,s+i>a?a:s+i));1===r?(e=t[n-1],o.push(f[e>>2]+f[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(f[e>>10]+f[e>>4&63]+f[e<<2&63]+"="));return o.join("")}},f=[],h=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,g=l.length;p<g;++p)f[p]=l[p],h[l.charCodeAt(p)]=p;function y(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function m(t,e,n){for(var r,o,i=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),i.push(f[(o=r)>>18&63]+f[o>>12&63]+f[o>>6&63]+f[63&o]);return i.join("")}h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63;var w,b={};
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */b.read=function(t,e,n,r,o){var i,s,a=8*o-r-1,u=(1<<a)-1,c=u>>1,f=-7,h=n?o-1:0,d=n?-1:1,l=t[e+h];for(h+=d,i=l&(1<<-f)-1,l>>=-f,f+=a;f>0;i=256*i+t[e+h],h+=d,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=r;f>0;s=256*s+t[e+h],h+=d,f-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(l?-1:1);s+=Math.pow(2,r),i-=c}return(l?-1:1)*s*Math.pow(2,i-r)},b.write=function(t,e,n,r,o,i){var s,a,u,c=8*i-o-1,f=(1<<c)-1,h=f>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,l=r?0:i-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+h>=1?d/u:d*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=f?(a=0,s=f):s+h>=1?(a=(e*u-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[n+l]=255&a,l+=p,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;t[n+l]=255&s,l+=p,s/=256,c-=8);t[n+l-p]|=128*g},
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
function(t){const e=c,n=b,r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function i(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return f(t)}return a(t,e,n)}function a(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|p(t,e);let r=i(n);const o=r.write(t,e);o!==n&&(r=r.slice(0,o));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Z(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return h(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Z(t,ArrayBuffer)||t&&Z(t.buffer,ArrayBuffer))return d(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(Z(t,SharedArrayBuffer)||t&&Z(t.buffer,SharedArrayBuffer)))return d(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return s.from(r,e,n);const o=function(t){if(s.isBuffer(t)){const e=0|l(t.length),n=i(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!=typeof t.length||K(t.length)?i(0):h(t);if("Buffer"===t.type&&Array.isArray(t.data))return h(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function f(t){return u(t),i(t<0?0:0|l(t))}function h(t){const e=t.length<0?0:0|l(t.length),n=i(e);for(let r=0;r<e;r+=1)n[r]=255&t[r];return n}function d(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,s.prototype),r}function l(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function p(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Z(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return G(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return J(t).length;default:if(o)return r?-1:G(t).length;e=(""+e).toLowerCase(),o=!0}}function g(t,e,n){let r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return L(this,e,n);case"utf8":case"utf-8":return B(this,e,n);case"ascii":return P(this,e,n);case"latin1":case"binary":return U(this,e,n);case"base64":return v(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),K(n=+n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:w(t,e,n,r,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):w(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function w(t,e,n,r,o){let i,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){let r=-1;for(i=n;i<a;i++)if(c(t,i)===c(e,-1===r?0:i-r)){if(-1===r&&(r=i),i-r+1===u)return r*s}else-1!==r&&(i-=i-r),r=-1}else for(n+u>a&&(n=a-u),i=n;i>=0;i--){let n=!0;for(let r=0;r<u;r++)if(c(t,i+r)!==c(e,r)){n=!1;break}if(n)return i}return-1}function k(t,e,n,r){n=Number(n)||0;const o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;const i=e.length;let s;for(r>i/2&&(r=i/2),s=0;s<r;++s){const r=parseInt(e.substr(2*s,2),16);if(K(r))return s;t[n+s]=r}return s}function I(t,e,n,r){return Y(G(e,t.length-n),t,n,r)}function E(t,e,n,r){return Y(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function A(t,e,n,r){return Y(J(e),t,n,r)}function S(t,e,n,r){return Y(function(t,e){let n,r,o;const i=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function v(t,n,r){return 0===n&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,r))}function B(t,e,n){n=Math.min(t.length,n);const r=[];let o=e;for(;o<n;){const e=t[o];let i=null,s=e>239?4:e>223?3:e>191?2:1;if(o+s<=n){let n,r,a,u;switch(s){case 1:e<128&&(i=e);break;case 2:n=t[o+1],128==(192&n)&&(u=(31&e)<<6|63&n,u>127&&(i=u));break;case 3:n=t[o+1],r=t[o+2],128==(192&n)&&128==(192&r)&&(u=(15&e)<<12|(63&n)<<6|63&r,u>2047&&(u<55296||u>57343)&&(i=u));break;case 4:n=t[o+1],r=t[o+2],a=t[o+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(u=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&a,u>65535&&u<1114112&&(i=u))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=s}return function(t){const e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=T));return n}(r)}t.kMaxLength=o,s.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,n){return a(t,e,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,n){return function(t,e,n){return u(t),t<=0?i(t):void 0!==e?"string"==typeof n?i(t).fill(e,n):i(t).fill(e):i(t)}(t,e,n)},s.allocUnsafe=function(t){return f(t)},s.allocUnsafeSlow=function(t){return f(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(Z(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),Z(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const r=s.allocUnsafe(e);let o=0;for(n=0;n<t.length;++n){let e=t[n];if(Z(e,Uint8Array))o+e.length>r.length?(s.isBuffer(e)||(e=s.from(e)),e.copy(r,o)):Uint8Array.prototype.set.call(r,e,o);else{if(!s.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(r,o)}o+=e.length}return r},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)y(this,e,e+1);return this},s.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},s.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},s.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?B(this,0,t):g.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(t,e,n,r,o){if(Z(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;let i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0);const u=Math.min(i,a),c=this.slice(r,o),f=t.slice(e,n);for(let t=0;t<u;++t)if(c[t]!==f[t]){i=c[t],a=f[t];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},s.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return k(this,t,e,n);case"utf8":case"utf-8":return I(this,t,e,n);case"ascii":case"latin1":case"binary":return E(this,t,e,n);case"base64":return A(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function P(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function U(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function L(t,e,n){const r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let o="";for(let r=e;r<n;++r)o+=H[t[r]];return o}function x(t,e,n){const r=t.slice(e,n);let o="";for(let t=0;t<r.length-1;t+=2)o+=String.fromCharCode(r[t]+256*r[t+1]);return o}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,n,r,o,i){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function C(t,e,n,r,o){F(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function O(t,e,n,r,o){F(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n+7]=i,i>>=8,t[n+6]=i,i>>=8,t[n+5]=i,i>>=8,t[n+4]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function z(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function _(t,e,r,o,i){return e=+e,r>>>=0,i||z(t,0,r,4),n.write(t,e,r,o,23,4),r+4}function N(t,e,r,o,i){return e=+e,r>>>=0,i||z(t,0,r,8),n.write(t,e,r,o,52,8),r+8}s.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const r=this.subarray(t,e);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||R(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return r},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||R(t,e,this.length);let r=this[t+--e],o=1;for(;e>0&&(o*=256);)r+=this[t+--e]*o;return r},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||R(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||R(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||R(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readBigUInt64LE=X((function(t){j(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,o=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(r)+(BigInt(o)<<BigInt(32))})),s.prototype.readBigUInt64BE=X((function(t){j(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=e*2**24+65536*this[++t]+256*this[++t]+this[++t],o=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(r)<<BigInt(32))+BigInt(o)})),s.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||R(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},s.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||R(t,e,this.length);let r=e,o=1,i=this[t+--r];for(;r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},s.prototype.readInt8=function(t,e){return t>>>=0,e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||R(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){t>>>=0,e||R(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readBigInt64LE=X((function(t){j(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),s.prototype.readBigInt64BE=X((function(t){j(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),s.prototype.readFloatLE=function(t,e){return t>>>=0,e||R(t,4,this.length),n.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||R(t,4,this.length),n.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||R(t,8,this.length),n.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||R(t,8,this.length),n.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){M(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){M(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||M(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||M(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||M(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||M(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||M(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigUInt64LE=X((function(t,e=0){return C(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=X((function(t,e=0){return O(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);M(this,t,e,n,r-1,-r)}let o=0,i=1,s=0;for(this[e]=255&t;++o<n&&(i*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+n},s.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);M(this,t,e,n,r-1,-r)}let o=n-1,i=1,s=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||M(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||M(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||M(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||M(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigInt64LE=X((function(t,e=0){return C(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=X((function(t,e=0){return O(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(t,e,n){return _(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return _(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return N(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return N(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);const o=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),o},s.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){const e=t.charCodeAt(0);("utf8"===r&&e<128||"latin1"===r)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{const i=s.isBuffer(t)?t:s.from(t,r),a=i.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=i[o%a]}return this};const $={};function W(t,e,n){$[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function D(t){let e="",n=t.length;const r="-"===t[0]?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function F(t,e,n,r,o,i){if(t>n||t<e){const r="bigint"==typeof e?"n":"";let o;throw o=i>3?0===e||e===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`:`>= ${e}${r} and <= ${n}${r}`,new $.ERR_OUT_OF_RANGE("value",o,t)}!function(t,e,n){j(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||q(e,t.length-(n+1))}(r,o,i)}function j(t,e){if("number"!=typeof t)throw new $.ERR_INVALID_ARG_TYPE(e,"number",t)}function q(t,e,n){if(Math.floor(t)!==t)throw j(t,n),new $.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new $.ERR_BUFFER_OUT_OF_BOUNDS;throw new $.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}W("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),W("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),W("ERR_OUT_OF_RANGE",(function(t,e,n){let r=`The value of "${t}" is out of range.`,o=n;return Number.isInteger(n)&&Math.abs(n)>2**32?o=D(String(n)):"bigint"==typeof n&&(o=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(o=D(o)),o+="n"),r+=` It must be ${e}. Received ${o}`,r}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function G(t,e){let n;e=e||1/0;const r=t.length;let o=null;const i=[];for(let s=0;s<r;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function J(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Y(t,e,n,r){let o;for(o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function Z(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function K(t){return t!=t}const H=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let o=0;o<16;++o)e[r+o]=t[n]+t[o]}return e}();function X(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}}(u),function(t){t[t.InitializeMint=0]="InitializeMint",t[t.InitializeAccount=1]="InitializeAccount",t[t.InitializeMultisig=2]="InitializeMultisig",t[t.Transfer=3]="Transfer",t[t.Approve=4]="Approve",t[t.Revoke=5]="Revoke",t[t.SetAuthority=6]="SetAuthority",t[t.MintTo=7]="MintTo",t[t.Burn=8]="Burn",t[t.CloseAccount=9]="CloseAccount",t[t.FreezeAccount=10]="FreezeAccount",t[t.ThawAccount=11]="ThawAccount",t[t.TransferChecked=12]="TransferChecked",t[t.ApproveChecked=13]="ApproveChecked",t[t.MintToChecked=14]="MintToChecked",t[t.BurnChecked=15]="BurnChecked",t[t.InitializeAccount2=16]="InitializeAccount2",t[t.SyncNative=17]="SyncNative",t[t.InitializeAccount3=18]="InitializeAccount3",t[t.InitializeMultisig2=19]="InitializeMultisig2",t[t.InitializeMint2=20]="InitializeMint2"}(w||(w={}));var k={};Object.defineProperty(k,"__esModule",{value:!0}),k.s16=k.s8=k.nu64be=k.u48be=k.u40be=k.u32be=k.u24be=k.u16be=k.nu64=k.u48=k.u40=k.u32=k.u24=k.u16=ot=k.u8=k.offset=k.greedy=k.Constant=k.UTF8=k.CString=k.Blob=k.Boolean=k.BitField=k.BitStructure=k.VariantLayout=k.Union=k.UnionLayoutDiscriminator=k.UnionDiscriminator=k.Structure=k.Sequence=k.DoubleBE=k.Double=k.FloatBE=k.Float=k.NearInt64BE=k.NearInt64=k.NearUInt64BE=k.NearUInt64=k.IntBE=k.Int=k.UIntBE=k.UInt=k.OffsetLayout=k.GreedyCount=k.ExternalLayout=k.bindConstructorLayout=k.nameWithProperty=k.Layout=k.uint8ArrayToBuffer=k.checkUint8Array=void 0,k.constant=k.utf8=k.cstr=st=k.blob=k.unionLayoutDiscriminator=k.union=k.seq=k.bits=it=k.struct=k.f64be=k.f64=k.f32be=k.f32=k.ns64be=k.s48be=k.s40be=k.s32be=k.s24be=k.s16be=k.ns64=k.s48=k.s40=k.s32=k.s24=void 0;const I=u;function E(t){if(!(t instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function A(t){return E(t),I.Buffer.from(t.buffer,t.byteOffset,t.length)}k.checkUint8Array=E,k.uint8ArrayToBuffer=A;class S{constructor(t,e){if(!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=e}makeDestinationObject(){return{}}getSpan(t,e){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(t){const e=Object.create(this.constructor.prototype);return Object.assign(e,this),e.property=t,e}fromArray(t){}}function v(t,e){return e.property?t+"["+e.property+"]":t}k.Layout=S,k.nameWithProperty=v,k.bindConstructorLayout=function(t,e){if("function"!=typeof t)throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(t,"layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof S))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(e,"boundConstructor_"))throw new Error("layout is already bound to a constructor");t.layout_=e,e.boundConstructor_=t,e.makeDestinationObject=()=>new t,Object.defineProperty(t.prototype,"encode",{value(t,n){return e.encode(this,t,n)},writable:!0}),Object.defineProperty(t,"decode",{value:(t,n)=>e.decode(t,n),writable:!0})};class B extends S{isCount(){throw new Error("ExternalLayout is abstract")}}k.ExternalLayout=B;class T extends B{constructor(t=1,e){if(!Number.isInteger(t)||0>=t)throw new TypeError("elementSpan must be a (positive) integer");super(-1,e),this.elementSpan=t}isCount(){return!0}decode(t,e=0){E(t);const n=t.length-e;return Math.floor(n/this.elementSpan)}encode(t,e,n){return 0}}k.GreedyCount=T;class P extends B{constructor(t,e=0,n){if(!(t instanceof S))throw new TypeError("layout must be a Layout");if(!Number.isInteger(e))throw new TypeError("offset must be integer or undefined");super(t.span,n||t.property),this.layout=t,this.offset=e}isCount(){return this.layout instanceof U||this.layout instanceof L}decode(t,e=0){return this.layout.decode(t,e+this.offset)}encode(t,e,n=0){return this.layout.encode(t,e,n+this.offset)}}k.OffsetLayout=P;class U extends S{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return A(t).readUIntLE(e,this.span)}encode(t,e,n=0){return A(e).writeUIntLE(t,n,this.span),this.span}}k.UInt=U;class L extends S{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return A(t).readUIntBE(e,this.span)}encode(t,e,n=0){return A(e).writeUIntBE(t,n,this.span),this.span}}k.UIntBE=L;class x extends S{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return A(t).readIntLE(e,this.span)}encode(t,e,n=0){return A(e).writeIntLE(t,n,this.span),this.span}}k.Int=x;class R extends S{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return A(t).readIntBE(e,this.span)}encode(t,e,n=0){return A(e).writeIntBE(t,n,this.span),this.span}}k.IntBE=R;const M=Math.pow(2,32);function C(t){const e=Math.floor(t/M);return{hi32:e,lo32:t-e*M}}function O(t,e){return t*M+e}class z extends S{constructor(t){super(8,t)}decode(t,e=0){const n=A(t),r=n.readUInt32LE(e);return O(n.readUInt32LE(e+4),r)}encode(t,e,n=0){const r=C(t),o=A(e);return o.writeUInt32LE(r.lo32,n),o.writeUInt32LE(r.hi32,n+4),8}}k.NearUInt64=z;class _ extends S{constructor(t){super(8,t)}decode(t,e=0){const n=A(t);return O(n.readUInt32BE(e),n.readUInt32BE(e+4))}encode(t,e,n=0){const r=C(t),o=A(e);return o.writeUInt32BE(r.hi32,n),o.writeUInt32BE(r.lo32,n+4),8}}k.NearUInt64BE=_;class N extends S{constructor(t){super(8,t)}decode(t,e=0){const n=A(t),r=n.readUInt32LE(e);return O(n.readInt32LE(e+4),r)}encode(t,e,n=0){const r=C(t),o=A(e);return o.writeUInt32LE(r.lo32,n),o.writeInt32LE(r.hi32,n+4),8}}k.NearInt64=N;class $ extends S{constructor(t){super(8,t)}decode(t,e=0){const n=A(t);return O(n.readInt32BE(e),n.readUInt32BE(e+4))}encode(t,e,n=0){const r=C(t),o=A(e);return o.writeInt32BE(r.hi32,n),o.writeUInt32BE(r.lo32,n+4),8}}k.NearInt64BE=$;class W extends S{constructor(t){super(4,t)}decode(t,e=0){return A(t).readFloatLE(e)}encode(t,e,n=0){return A(e).writeFloatLE(t,n),4}}k.Float=W;class D extends S{constructor(t){super(4,t)}decode(t,e=0){return A(t).readFloatBE(e)}encode(t,e,n=0){return A(e).writeFloatBE(t,n),4}}k.FloatBE=D;class F extends S{constructor(t){super(8,t)}decode(t,e=0){return A(t).readDoubleLE(e)}encode(t,e,n=0){return A(e).writeDoubleLE(t,n),8}}k.Double=F;class j extends S{constructor(t){super(8,t)}decode(t,e=0){return A(t).readDoubleBE(e)}encode(t,e,n=0){return A(e).writeDoubleBE(t,n),8}}k.DoubleBE=j;class q extends S{constructor(t,e,n){if(!(t instanceof S))throw new TypeError("elementLayout must be a Layout");if(!(e instanceof B&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let r=-1;!(e instanceof B)&&0<t.span&&(r=e*t.span),super(r,n),this.elementLayout=t,this.count=e}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0,r=this.count;if(r instanceof B&&(r=r.decode(t,e)),0<this.elementLayout.span)n=r*this.elementLayout.span;else{let o=0;for(;o<r;)n+=this.elementLayout.getSpan(t,e+n),++o}return n}decode(t,e=0){const n=[];let r=0,o=this.count;for(o instanceof B&&(o=o.decode(t,e));r<o;)n.push(this.elementLayout.decode(t,e)),e+=this.elementLayout.getSpan(t,e),r+=1;return n}encode(t,e,n=0){const r=this.elementLayout,o=t.reduce(((t,o)=>t+r.encode(o,e,n+t)),0);return this.count instanceof B&&this.count.encode(t.length,e,n),o}}k.Sequence=q;class V extends S{constructor(t,e,n){if(!Array.isArray(t)||!t.reduce(((t,e)=>t&&e instanceof S),!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof e&&void 0===n&&(n=e,e=void 0);for(const e of t)if(0>e.span&&void 0===e.property)throw new Error("fields cannot contain unnamed variable-length layout");let r=-1;try{r=t.reduce(((t,e)=>t+e.getSpan()),0)}catch(t){}super(r,e),this.fields=t,this.decodePrefixes=!!n}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0;try{n=this.fields.reduce(((n,r)=>{const o=r.getSpan(t,e);return e+=o,n+o}),0)}catch(t){throw new RangeError("indeterminate span")}return n}decode(t,e=0){E(t);const n=this.makeDestinationObject();for(const r of this.fields)if(void 0!==r.property&&(n[r.property]=r.decode(t,e)),e+=r.getSpan(t,e),this.decodePrefixes&&t.length===e)break;return n}encode(t,e,n=0){const r=n;let o=0,i=0;for(const r of this.fields){let s=r.span;if(i=0<s?s:0,void 0!==r.property){const o=t[r.property];void 0!==o&&(i=r.encode(o,e,n),0>s&&(s=r.getSpan(e,n)))}o=n,n+=s}return o+i-r}fromArray(t){const e=this.makeDestinationObject();for(const n of this.fields)void 0!==n.property&&0<t.length&&(e[n.property]=t.shift());return e}layoutFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}offsetOf(t){if("string"!=typeof t)throw new TypeError("property must be string");let e=0;for(const n of this.fields){if(n.property===t)return e;0>n.span?e=-1:0<=e&&(e+=n.span)}}}k.Structure=V;class G{constructor(t){this.property=t}decode(t,e){throw new Error("UnionDiscriminator is abstract")}encode(t,e,n){throw new Error("UnionDiscriminator is abstract")}}k.UnionDiscriminator=G;class J extends G{constructor(t,e){if(!(t instanceof B&&t.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(e||t.property||"variant"),this.layout=t}decode(t,e){return this.layout.decode(t,e)}encode(t,e,n){return this.layout.encode(t,e,n)}}k.UnionLayoutDiscriminator=J;class Y extends S{constructor(t,e,n){let r;if(t instanceof U||t instanceof L)r=new J(new P(t));else if(t instanceof B&&t.isCount())r=new J(t);else{if(!(t instanceof G))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");r=t}if(void 0===e&&(e=null),!(null===e||e instanceof S))throw new TypeError("defaultLayout must be null or a Layout");if(null!==e){if(0>e.span)throw new Error("defaultLayout must have constant span");void 0===e.property&&(e=e.replicate("content"))}let o=-1;e&&(o=e.span,0<=o&&(t instanceof U||t instanceof L)&&(o+=r.layout.span)),super(o,n),this.discriminator=r,this.usesPrefixDiscriminator=t instanceof U||t instanceof L,this.defaultLayout=e,this.registry={};let i=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(t){return i(t)},this.configGetSourceVariant=function(t){i=t.bind(this)}}getSpan(t,e=0){if(0<=this.span)return this.span;const n=this.getVariant(t,e);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(t,e)}defaultGetSourceVariant(t){if(Object.prototype.hasOwnProperty.call(t,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(t,this.defaultLayout.property))return;const e=this.registry[t[this.discriminator.property]];if(e&&(!e.layout||e.property&&Object.prototype.hasOwnProperty.call(t,e.property)))return e}else for(const e in this.registry){const n=this.registry[e];if(n.property&&Object.prototype.hasOwnProperty.call(t,n.property))return n}throw new Error("unable to infer src variant")}decode(t,e=0){let n;const r=this.discriminator,o=r.decode(t,e),i=this.registry[o];if(void 0===i){const i=this.defaultLayout;let s=0;this.usesPrefixDiscriminator&&(s=r.layout.span),n=this.makeDestinationObject(),n[r.property]=o,n[i.property]=i.decode(t,e+s)}else n=i.decode(t,e);return n}encode(t,e,n=0){const r=this.getSourceVariant(t);if(void 0===r){const r=this.discriminator,o=this.defaultLayout;let i=0;return this.usesPrefixDiscriminator&&(i=r.layout.span),r.encode(t[r.property],e,n),i+o.encode(t[o.property],e,n+i)}return r.encode(t,e,n)}addVariant(t,e,n){const r=new Z(this,t,e,n);return this.registry[t]=r,r}getVariant(t,e=0){let n;return n=t instanceof Uint8Array?this.discriminator.decode(t,e):t,this.registry[n]}}k.Union=Y;class Z extends S{constructor(t,e,n,r){if(!(t instanceof Y))throw new TypeError("union must be a Union");if(!Number.isInteger(e)||0>e)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof n&&void 0===r&&(r=n,n=null),n){if(!(n instanceof S))throw new TypeError("layout must be a Layout");if(null!==t.defaultLayout&&0<=n.span&&n.span>t.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof r)throw new TypeError("variant must have a String property")}let o=t.span;0>t.span&&(o=n?n.span:0,0<=o&&t.usesPrefixDiscriminator&&(o+=t.discriminator.layout.span)),super(o,r),this.union=t,this.variant=e,this.layout=n||null}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0;this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span);let r=0;return this.layout&&(r=this.layout.getSpan(t,e+n)),n+r}decode(t,e=0){const n=this.makeDestinationObject();if(this!==this.union.getVariant(t,e))throw new Error("variant mismatch");let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(t,e+r):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(t,e,n=0){let r=0;if(this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(t,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,e,n);let o=r;if(this.layout&&(this.layout.encode(t[this.property],e,n+r),o+=this.layout.getSpan(e,n+r),0<=this.union.span&&o>this.union.span))throw new Error("encoded variant overruns containing union");return o}fromArray(t){if(this.layout)return this.layout.fromArray(t)}}function K(t){return 0>t&&(t+=4294967296),t}k.VariantLayout=Z;class H extends S{constructor(t,e,n){if(!(t instanceof U||t instanceof L))throw new TypeError("word must be a UInt or UIntBE layout");if("string"==typeof e&&void 0===n&&(n=e,e=!1),4<t.span)throw new RangeError("word cannot exceed 32 bits");super(t.span,n),this.word=t,this.msb=!!e,this.fields=[];let r=0;this._packedSetValue=function(t){return r=K(t),this},this._packedGetValue=function(){return r}}decode(t,e=0){const n=this.makeDestinationObject(),r=this.word.decode(t,e);this._packedSetValue(r);for(const e of this.fields)void 0!==e.property&&(n[e.property]=e.decode(t));return n}encode(t,e,n=0){const r=this.word.decode(e,n);this._packedSetValue(r);for(const e of this.fields)if(void 0!==e.property){const n=t[e.property];void 0!==n&&e.encode(n)}return this.word.encode(this._packedGetValue(),e,n)}addField(t,e){const n=new X(this,t,e);return this.fields.push(n),n}addBoolean(t){const e=new Q(this,t);return this.fields.push(e),e}fieldFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}}k.BitStructure=H;class X{constructor(t,e,n){if(!(t instanceof H))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(e)||0>=e)throw new TypeError("bits must be positive integer");const r=8*t.span,o=t.fields.reduce(((t,e)=>t+e.bits),0);if(e+o>r)throw new Error("bits too long for span remainder ("+(r-o)+" of "+r+" remain)");this.container=t,this.bits=e,this.valueMask=(1<<e)-1,32===e&&(this.valueMask=4294967295),this.start=o,this.container.msb&&(this.start=r-o-e),this.wordMask=K(this.valueMask<<this.start),this.property=n}decode(t,e){return K(this.container._packedGetValue()&this.wordMask)>>>this.start}encode(t){if("number"!=typeof t||!Number.isInteger(t)||t!==K(t&this.valueMask))throw new TypeError(v("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const e=this.container._packedGetValue(),n=K(t<<this.start);this.container._packedSetValue(K(e&~this.wordMask)|n)}}k.BitField=X;class Q extends X{constructor(t,e){super(t,1,e)}decode(t,e){return!!super.decode(t,e)}encode(t){"boolean"==typeof t&&(t=+t),super.encode(t)}}k.Boolean=Q;class tt extends S{constructor(t,e){if(!(t instanceof B&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;t instanceof B||(n=t),super(n,e),this.length=t}getSpan(t,e){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),n}decode(t,e=0){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),A(t).slice(e,e+n)}encode(t,e,n){let r=this.length;if(this.length instanceof B&&(r=t.length),!(t instanceof Uint8Array&&r===t.length))throw new TypeError(v("Blob.encode",this)+" requires (length "+r+") Uint8Array as src");if(n+r>e.length)throw new RangeError("encoding overruns Uint8Array");const o=A(t);return A(e).write(o.toString("hex"),n,r,"hex"),this.length instanceof B&&this.length.encode(r,e,n),r}}k.Blob=tt;class et extends S{constructor(t){super(-1,t)}getSpan(t,e=0){E(t);let n=e;for(;n<t.length&&0!==t[n];)n+=1;return 1+n-e}decode(t,e=0){const n=this.getSpan(t,e);return A(t).slice(e,e+n-1).toString("utf-8")}encode(t,e,n=0){"string"!=typeof t&&(t=String(t));const r=I.Buffer.from(t,"utf8"),o=r.length;if(n+o>e.length)throw new RangeError("encoding overruns Buffer");const i=A(e);return r.copy(i,n),i[n+o]=0,o+1}}k.CString=et;class nt extends S{constructor(t,e){if("string"==typeof t&&void 0===e&&(e=t,t=void 0),void 0===t)t=-1;else if(!Number.isInteger(t))throw new TypeError("maxSpan must be an integer");super(-1,e),this.maxSpan=t}getSpan(t,e=0){return E(t),t.length-e}decode(t,e=0){const n=this.getSpan(t,e);if(0<=this.maxSpan&&this.maxSpan<n)throw new RangeError("text length exceeds maxSpan");return A(t).slice(e,e+n).toString("utf-8")}encode(t,e,n=0){"string"!=typeof t&&(t=String(t));const r=I.Buffer.from(t,"utf8"),o=r.length;if(0<=this.maxSpan&&this.maxSpan<o)throw new RangeError("text length exceeds maxSpan");if(n+o>e.length)throw new RangeError("encoding overruns Buffer");return r.copy(A(e),n),o}}k.UTF8=nt;class rt extends S{constructor(t,e){super(0,e),this.value=t}decode(t,e){return this.value}encode(t,e,n){return 0}}k.Constant=rt,k.greedy=(t,e)=>new T(t,e),k.offset=(t,e,n)=>new P(t,e,n);var ot=k.u8=t=>new U(1,t);k.u16=t=>new U(2,t),k.u24=t=>new U(3,t),k.u32=t=>new U(4,t),k.u40=t=>new U(5,t),k.u48=t=>new U(6,t),k.nu64=t=>new z(t),k.u16be=t=>new L(2,t),k.u24be=t=>new L(3,t),k.u32be=t=>new L(4,t),k.u40be=t=>new L(5,t),k.u48be=t=>new L(6,t),k.nu64be=t=>new _(t),k.s8=t=>new x(1,t),k.s16=t=>new x(2,t),k.s24=t=>new x(3,t),k.s32=t=>new x(4,t),k.s40=t=>new x(5,t),k.s48=t=>new x(6,t),k.ns64=t=>new N(t),k.s16be=t=>new R(2,t),k.s24be=t=>new R(3,t),k.s32be=t=>new R(4,t),k.s40be=t=>new R(5,t),k.s48be=t=>new R(6,t),k.ns64be=t=>new $(t),k.f32=t=>new W(t),k.f32be=t=>new D(t),k.f64=t=>new F(t),k.f64be=t=>new j(t);var it=k.struct=(t,e,n)=>new V(t,e,n);k.bits=(t,e,n)=>new H(t,e,n),k.seq=(t,e,n)=>new q(t,e,n),k.union=(t,e,n)=>new Y(t,e,n),k.unionLayoutDiscriminator=(t,e)=>new J(t,e);var st=k.blob=(t,e)=>new tt(t,e);k.cstr=t=>new et(t),k.utf8=(t,e)=>new nt(t,e),k.constant=(t,e)=>new rt(t,e);const at=t=>({decode:t.decode.bind(t),encode:t.encode.bind(t)});var ut={};Object.defineProperty(ut,"__esModule",{value:!0});var ct=ut.toBigIntLE=function(t){{const e=Buffer.from(t);e.reverse();const n=e.toString("hex");return 0===n.length?BigInt(0):BigInt(`0x${n}`)}};ut.toBigIntBE=function(t){{const e=t.toString("hex");return 0===e.length?BigInt(0):BigInt(`0x${e}`)}};var ft=ut.toBufferLE=function(t,e){{const n=t.toString(16),r=Buffer.from(n.padStart(2*e,"0").slice(0,2*e),"hex");return r.reverse(),r}};ut.toBufferBE=function(t,e){{const n=t.toString(16);return Buffer.from(n.padStart(2*e,"0").slice(0,2*e),"hex")}};const ht=(dt=8,t=>{const e=st(dt,t),{encode:n,decode:r}=at(e),o=e;return o.decode=(t,e)=>{const n=r(t,e);return ct(Buffer.from(n))},o.encode=(t,e,r)=>{const o=ft(t,dt);return n(o,e,r)},o});var dt;const lt=e=>{const n=st(32,e),{encode:r,decode:o}=at(n),i=n;return i.decode=(e,n)=>{const r=o(e,n);return new t(r)},i.encode=(t,e,n)=>{const o=t.toBuffer();return r(o,e,n)},i},pt=new t("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),gt=new t("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");new t("So11111111111111111111111111111111111111112");class yt extends Error{constructor(t){super(t)}}class mt extends yt{constructor(){super(...arguments),this.name="TokenInvalidInstructionProgramError"}}class wt extends yt{constructor(){super(...arguments),this.name="TokenInvalidInstructionKeysError"}}class bt extends yt{constructor(){super(...arguments),this.name="TokenInvalidInstructionDataError"}}class kt extends yt{constructor(){super(...arguments),this.name="TokenInvalidInstructionTypeError"}}const It=it([ot("instruction"),ot("decimals"),lt("mintAuthority"),ot("freezeAuthorityOption"),lt("freezeAuthority")]);function Et({programId:t,keys:[e,n],data:r}){const{instruction:o,decimals:i,mintAuthority:s,freezeAuthorityOption:a,freezeAuthority:u}=It.decode(r);return{programId:t,keys:{mint:e,rent:n},data:{instruction:o,decimals:i,mintAuthority:s,freezeAuthority:a?u:null}}}const At=it([ot("instruction")]);function St(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==At.span)throw new bt;const{keys:{account:n,mint:r,owner:o,rent:i},data:s}=function({programId:t,keys:[e,n,r,o],data:i}){return{programId:t,keys:{account:e,mint:n,owner:r,rent:o},data:At.decode(i)}}(t);if(s.instruction!==w.InitializeAccount)throw new kt;if(!(n&&r&&o&&i))throw new wt;return{programId:e,keys:{account:n,mint:r,owner:o,rent:i},data:s}}const vt=it([ot("instruction"),ot("m")]);function Bt(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==vt.span)throw new bt;const{keys:{account:n,rent:r,signers:o},data:i}=function({programId:t,keys:[e,n,...r],data:o}){return{programId:t,keys:{account:e,rent:n,signers:r},data:vt.decode(o)}}(t);if(i.instruction!==w.InitializeMultisig)throw new kt;if(!n||!r||!o.length)throw new wt;return{programId:e,keys:{account:n,rent:r,signers:o},data:i}}const Tt=it([ot("instruction"),ht("amount")]);function Pt(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==Tt.span)throw new bt;const{keys:{source:n,destination:r,owner:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{source:e,destination:n,owner:r,multiSigners:o},data:Tt.decode(i)}}(t);if(s.instruction!==w.Transfer)throw new kt;if(!n||!r||!o)throw new wt;return{programId:e,keys:{source:n,destination:r,owner:o,multiSigners:i},data:s}}const Ut=it([ot("instruction"),ht("amount")]);function Lt(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==Ut.span)throw new bt;const{keys:{account:n,delegate:r,owner:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,delegate:n,owner:r,multiSigners:o},data:Ut.decode(i)}}(t);if(s.instruction!==w.Approve)throw new kt;if(!n||!r||!o)throw new wt;return{programId:e,keys:{account:n,delegate:r,owner:o,multiSigners:i},data:s}}const xt=it([ot("instruction")]);function Rt(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==xt.span)throw new bt;const{keys:{account:n,owner:r,multiSigners:o},data:i}=function({programId:t,keys:[e,n,...r],data:o}){return{programId:t,keys:{account:e,owner:n,multiSigners:r},data:xt.decode(o)}}(t);if(i.instruction!==w.Revoke)throw new kt;if(!n||!r)throw new wt;return{programId:e,keys:{account:n,owner:r,multiSigners:o},data:i}}var Mt;!function(t){t[t.MintTokens=0]="MintTokens",t[t.FreezeAccount=1]="FreezeAccount",t[t.AccountOwner=2]="AccountOwner",t[t.CloseAccount=3]="CloseAccount"}(Mt||(Mt={}));const Ct=it([ot("instruction"),ot("authorityType"),ot("newAuthorityOption"),lt("newAuthority")]);function Ot(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==Ct.span)throw new bt;const{keys:{account:n,currentAuthority:r,multiSigners:o},data:i}=function({programId:t,keys:[e,n,...r],data:o}){const{instruction:i,authorityType:s,newAuthorityOption:a,newAuthority:u}=Ct.decode(o);return{programId:t,keys:{account:e,currentAuthority:n,multiSigners:r},data:{instruction:i,authorityType:s,newAuthority:a?u:null}}}(t);if(i.instruction!==w.SetAuthority)throw new kt;if(!n||!r)throw new wt;return{programId:e,keys:{account:n,currentAuthority:r,multiSigners:o},data:i}}const zt=it([ot("instruction"),ht("amount")]);function _t(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==zt.span)throw new bt;const{keys:{mint:n,destination:r,authority:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{mint:e,destination:n,authority:r,multiSigners:o},data:zt.decode(i)}}(t);if(s.instruction!==w.MintTo)throw new kt;if(!n||!r||!o)throw new wt;return{programId:e,keys:{mint:n,destination:r,authority:o,multiSigners:i},data:s}}const Nt=it([ot("instruction"),ht("amount")]);function $t(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==Nt.span)throw new bt;const{keys:{account:n,mint:r,owner:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,mint:n,owner:r,multiSigners:o},data:Nt.decode(i)}}(t);if(s.instruction!==w.Burn)throw new kt;if(!n||!r||!o)throw new wt;return{programId:e,keys:{account:n,mint:r,owner:o,multiSigners:i},data:s}}const Wt=it([ot("instruction")]);function Dt(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==Wt.span)throw new bt;const{keys:{account:n,destination:r,authority:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,destination:n,authority:r,multiSigners:o},data:Wt.decode(i)}}(t);if(s.instruction!==w.CloseAccount)throw new kt;if(!n||!r||!o)throw new wt;return{programId:e,keys:{account:n,destination:r,authority:o,multiSigners:i},data:s}}const Ft=it([ot("instruction")]);function jt(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==Ft.span)throw new bt;const{keys:{account:n,mint:r,authority:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,mint:n,authority:r,multiSigners:o},data:Ft.decode(i)}}(t);if(s.instruction!==w.FreezeAccount)throw new kt;if(!n||!r||!o)throw new wt;return{programId:e,keys:{account:n,mint:r,authority:o,multiSigners:i},data:s}}const qt=it([ot("instruction")]);function Vt(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==qt.span)throw new bt;const{keys:{account:n,mint:r,authority:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,mint:n,authority:r,multiSigners:o},data:qt.decode(i)}}(t);if(s.instruction!==w.ThawAccount)throw new kt;if(!n||!r||!o)throw new wt;return{programId:e,keys:{account:n,mint:r,authority:o,multiSigners:i},data:s}}const Gt=it([ot("instruction"),ht("amount"),ot("decimals")]);function Jt(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==Gt.span)throw new bt;const{keys:{source:n,mint:r,destination:o,owner:i,multiSigners:s},data:a}=function({programId:t,keys:[e,n,r,o,...i],data:s}){return{programId:t,keys:{source:e,mint:n,destination:r,owner:o,multiSigners:i},data:Gt.decode(s)}}(t);if(a.instruction!==w.TransferChecked)throw new kt;if(!(n&&r&&o&&i))throw new wt;return{programId:e,keys:{source:n,mint:r,destination:o,owner:i,multiSigners:s},data:a}}const Yt=it([ot("instruction"),ht("amount"),ot("decimals")]);function Zt(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==Yt.span)throw new bt;const{keys:{account:n,mint:r,delegate:o,owner:i,multiSigners:s},data:a}=function({programId:t,keys:[e,n,r,o,...i],data:s}){return{programId:t,keys:{account:e,mint:n,delegate:r,owner:o,multiSigners:i},data:Yt.decode(s)}}(t);if(a.instruction!==w.ApproveChecked)throw new kt;if(!(n&&r&&o&&i))throw new wt;return{programId:e,keys:{account:n,mint:r,delegate:o,owner:i,multiSigners:s},data:a}}const Kt=it([ot("instruction"),ht("amount"),ot("decimals")]);function Ht(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==Kt.span)throw new bt;const{keys:{mint:n,destination:r,authority:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{mint:e,destination:n,authority:r,multiSigners:o},data:Kt.decode(i)}}(t);if(s.instruction!==w.MintToChecked)throw new kt;if(!n||!r||!o)throw new wt;return{programId:e,keys:{mint:n,destination:r,authority:o,multiSigners:i},data:s}}const Xt=it([ot("instruction"),ht("amount"),ot("decimals")]);function Qt(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==Xt.span)throw new bt;const{keys:{account:n,mint:r,owner:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,mint:n,owner:r,multiSigners:o},data:Xt.decode(i)}}(t);if(s.instruction!==w.BurnChecked)throw new kt;if(!n||!r||!o)throw new wt;return{programId:e,keys:{account:n,mint:r,owner:o,multiSigners:i},data:s}}function te(t){const e=t.startsWith("0x")?t.slice(2):t;return Buffer.from(e)}function ee(e,n){const r="legacy"===e.version?e.accountKeys:e.staticAccountKeys,o=e.header.numReadonlySignedAccounts,i=e.header.numReadonlyUnsignedAccounts,s=e.header.numRequiredSignatures,a=r.length;let u=r.map(((e,n)=>({isSigner:n<s,isWritable:n<s-o||n>=s&&n<a-i,pubkey:new t(e)})));const[c,f]="legacy"===e.version?[[],[]]:n?[n.writable,n.readonly]:[[],[]];return c&&(u=[...u,...c.map((t=>({isSigner:!1,isWritable:!0,pubkey:t})))]),f&&(u=[...u,...f.map((t=>({isSigner:!1,isWritable:!1,pubkey:t})))]),u}function ne(t,n){if("string"==typeof t.data){const r=t;return new e({data:i.bytes.bs58.decode(r.data),programId:n[r.programIdIndex].pubkey,keys:r.accounts.map((t=>n[t]))})}{const r=t;return new e({data:Buffer.from(r.data),programId:n[r.programIdIndex].pubkey,keys:r.accountKeyIndexes.map((t=>{if(t>=n.length)throw new Error(`Trying to resolve account at index ${t} while parsedAccounts is only ${n.length}. \t\t\t\t\t\tLooks like you're trying to parse versioned transaction, make sure that LoadedAddresses are passed to the \t\t\t\t\t\tparseTransactionAccounts function`);return n[t]}))})}}function re(t,e){const n=e.map((t=>({pk:t.pubkey.toString(),...t})));return t.map((t=>{const e=t.toString(),r=n.find((t=>t.pk===e));if(!r)throw new Error(`Account ${e} not present in account meta!`);return r}))}function oe(t,n){return new e({data:i.bytes.bs58.decode(t.data),programId:t.programId,keys:re(t.accounts,n)})}function ie(t){var e,n,r;const o=[];if(null==t)return[];const i=t.transaction.message.compiledInstructions,s=ee(t.transaction.message,null===(e=t.meta)||void 0===e?void 0:e.loadedAddresses),a=((null===(n=null==t?void 0:t.meta)||void 0===n?void 0:n.innerInstructions)||[]).sort(((t,e)=>t.index-e.index)),u=((null===(r=t.meta)||void 0===r?void 0:r.innerInstructions)||[]).reduce(((t,e)=>t+e.instructions.length),0)+i.length;let c=-1,f=-1;for(const t of a){for(;c!==t.index;)c+=1,f+=1,o.push(ne(i[c],s));for(const e of t.instructions){const t=s[i[c].programIdIndex].pubkey;o.push({...ne(e,s),parentProgramId:t}),f+=1}}for(;f<u-1;)c+=1,f+=1,o.push(ne(i[c],s));return o}function se(t){var e,n;const r=[];if(!t)return r;const o=t.transaction.message.instructions,i=((null===(e=null==t?void 0:t.meta)||void 0===e?void 0:e.innerInstructions)||[]).sort(((t,e)=>t.index-e.index)),s=((null===(n=t.meta)||void 0===n?void 0:n.innerInstructions)||[]).reduce(((t,e)=>t+e.instructions.length),0)+o.length;let a=-1,u=-1;for(const t of i){for(;a!==t.index;)a+=1,u+=1,r.push(o[a]);for(const e of t.instructions){const t=o[a].programId;r.push({...e,parentProgramId:t}),u+=1}}for(;u<s-1;)a+=1,u+=1,r.push(o[a]);return r}function ae(t,e,n,r){return{logMessages:[],dataLogs:[],rawLogs:[],errors:[],programId:t,depth:e,id:n,instructionIndex:r}}function ue(t){const e=/(?<logTruncated>^Log truncated$)|(?<programInvoke>^Program (?<invokeProgramId>[1-9A-HJ-NP-Za-km-z]{32,}) invoke \[(?<level>\d+)\]$)|(?<programSuccessResult>^Program (?<successResultProgramId>[1-9A-HJ-NP-Za-km-z]{32,}) success$)|(?<programFailedResult>^Program (?<failedResultProgramId>[1-9A-HJ-NP-Za-km-z]{32,}) failed: (?<failedResultErr>.*)$)|(?<programCompleteFailedResult>^Program failed to complete: (?<failedCompleteError>.*)$)|(?<programLog>^^Program log: (?<logMessage>.*)$)|(?<programData>^Program data: (?<data>.*)$)|(?<programConsumed>^Program (?<consumedProgramId>[1-9A-HJ-NP-Za-km-z]{32,}) consumed (?<consumedComputeUnits>\d*) of (?<allComputedUnits>\d*) compute units$)|(?<programReturn>^Program return: (?<returnProgramId>[1-9A-HJ-NP-Za-km-z]{32,}) (?<returnMessage>.*)$)/s,n=[];let r=-1,o=0,i=0;const s=[],a=[];for(const u of t){const t=e.exec(u);if(!t||!t.groups)throw new Error(`Failed to parse log line: ${u}`);if(t.groups.logTruncated)n[a[a.length-1]].invokeResult="Log truncated";else if(t.groups.programInvoke){if(s.push(t.groups.invokeProgramId),r+=1,i+=1,a.push(r),t.groups.level!=i.toString())throw new Error(`invoke depth mismatch, log: ${t.groups.level}, expected: ${i}`);n.push(ae(s[s.length-1],s.length,r,o)),n[n.length-1].rawLogs.push(u)}else if(t.groups.programSuccessResult){const e=s.pop(),r=a.pop();if(void 0===r)throw new Error("callIds malformed");if(e!=t.groups.successResultProgramId)throw new Error("[ProramSuccess] callstack mismatch");n[r].rawLogs.push(u),i-=1,0===i&&(o+=1)}else if(t.groups.programFailedResult){if(s.pop()!=t.groups.failedResultProgramId)throw new Error("[ProgramFailed] callstack mismatch");n[a[a.length-1]].rawLogs.push(u),n[a[a.length-1]].errors.push(t.groups.failedResultErr)}else if(t.groups.programCompleteFailedResult)n[a[a.length-1]].rawLogs.push(u),n[a[a.length-1]].errors.push(t.groups.failedCompleteError);else if(t.groups.programLog)n[a[a.length-1]].rawLogs.push(u),n[a[a.length-1]].logMessages.push(t.groups.logMessage);else if(t.groups.programData)n[a[a.length-1]].rawLogs.push(u),n[a[a.length-1]].dataLogs.push(t.groups.data);else if(t.groups.programConsumed)n[a[a.length-1]].rawLogs.push(u);else if(t.groups.programReturn){if(s[s.length-1]!=t.groups.returnProgramId)throw new Error("[InvokeReturn]: callstack mismatch");n[a[a.length-1]].invokeResult=t.groups.returnMessage}}return n}function ce(t){let e;switch(o.decodeInstructionType(t)){case"AdvanceNonceAccount":{const n=o.decodeNonceAdvance(t);e={name:"advanceNonceAccount",accounts:[{name:"nonce",pubkey:n.noncePubkey,isSigner:!1,isWritable:!0},{name:"recentBlockhashSysvar",...t.keys[1]},{name:"nonceAuthority",pubkey:n.authorizedPubkey,isSigner:!0,isWritable:!1}],args:{}};break}case"Allocate":{const n=o.decodeAllocate(t);e={name:"allocate",accounts:[{name:"newAccount",pubkey:n.accountPubkey,isSigner:!0,isWritable:!0}],args:{space:new s(n.space)}};break}case"AllocateWithSeed":{const n=o.decodeAllocateWithSeed(t);e={name:"allocateWithSeed",accounts:[{name:"newAccount",pubkey:n.accountPubkey,isSigner:!1,isWritable:!0},{name:"base",pubkey:n.basePubkey,isSigner:!0,isWritable:!1}],args:{seed:n.seed,space:new s(n.space),owner:n.programId,base:n.basePubkey}};break}case"Assign":{const n=o.decodeAssign(t);e={name:"assign",accounts:[{name:"assignedAccount",pubkey:n.accountPubkey,isSigner:!0,isWritable:!0}],args:{owner:n.programId}};break}case"AssignWithSeed":{const n=o.decodeAssignWithSeed(t);e={name:"assignWithSeed",accounts:[{name:"assigned",pubkey:n.accountPubkey,isSigner:!1,isWritable:!0},{name:"base",pubkey:n.basePubkey,isSigner:!0,isWritable:!1}],args:{seed:n.seed,owner:n.programId,base:n.basePubkey}};break}case"AuthorizeNonceAccount":{const n=o.decodeNonceAuthorize(t);e={name:"authorizeNonceAccount",accounts:[{name:"nonce",isSigner:!1,isWritable:!0,pubkey:n.noncePubkey},{name:"nonceAuthority",isSigner:!0,isWritable:!1,pubkey:n.authorizedPubkey}],args:{authorized:n.newAuthorizedPubkey}};break}case"Create":{const n=o.decodeCreateAccount(t);e={name:"createAccount",accounts:[{name:"payer",pubkey:n.fromPubkey,isSigner:!0,isWritable:!0},{name:"newAccount",pubkey:n.newAccountPubkey,isSigner:!0,isWritable:!0}],args:{lamports:new s(n.lamports),owner:n.programId,space:new s(n.space)}};break}case"CreateWithSeed":{const n=o.decodeCreateWithSeed(t);e={name:"createAccountWithSeed",accounts:[{name:"payer",pubkey:n.fromPubkey,isSigner:!0,isWritable:!0},{name:"created",pubkey:n.newAccountPubkey,isSigner:!1,isWritable:!0},{name:"base",pubkey:n.basePubkey,isSigner:!0,isWritable:!1}],args:{lamports:new s(n.lamports),owner:n.programId,space:new s(n.space),seed:n.seed,base:n.basePubkey}};break}case"InitializeNonceAccount":{const n=o.decodeNonceInitialize(t);e={name:"initializeNonceAccount",accounts:[{name:"nonce",pubkey:n.noncePubkey,isSigner:!1,isWritable:!0},{name:"recentBlockhashSysvar",...t.keys[1]},{name:"rentSysvar",...t.keys[2]}],args:{authorized:n.authorizedPubkey}};break}case"Transfer":{const n=o.decodeTransfer(t);e={name:"transfer",accounts:[{name:"sender",pubkey:n.fromPubkey,isSigner:!0,isWritable:!0},{name:"receiver",pubkey:n.toPubkey,isWritable:!0,isSigner:!1}],args:{lamports:new s(n.lamports.toString())}};break}case"TransferWithSeed":{const n=o.decodeTransferWithSeed(t);e={name:"transferWithSeed",accounts:[{name:"sender",pubkey:n.fromPubkey,isSigner:!1,isWritable:!0},{name:"base",pubkey:n.basePubkey,isSigner:!0,isWritable:!1},{name:"receiver",pubkey:n.toPubkey,isSigner:!1,isWritable:!0}],args:{owner:n.programId,lamports:new s(n.lamports.toString()),seed:n.seed}};break}case"WithdrawNonceAccount":{const n=o.decodeNonceWithdraw(t);e={name:"withdrawNonceAccount",accounts:[{name:"nonce",pubkey:n.noncePubkey,isSigner:!1,isWritable:!0},{name:"recepient",pubkey:n.toPubkey,isSigner:!1,isWritable:!0},{name:"recentBlockhashSysvar",...t.keys[2]},{name:"rentSysvar",...t.keys[3]},{name:"nonceAuthority",pubkey:n.noncePubkey,isSigner:!0,isWritable:!1}],args:{lamports:new s(n.lamports)}};break}default:e=null}return e?{...e,programId:n.programId}:{programId:n.programId,name:"unknown",accounts:t.keys,args:{unknown:t.data}}}function fe(e){let n;switch(ot().decode(e.data)){case w.InitializeMint:{const t=function(t,e=pt){if(!t.programId.equals(e))throw new mt;if(t.data.length!==It.span)throw new bt;const{keys:{mint:n,rent:r},data:o}=Et(t);if(o.instruction!==w.InitializeMint)throw new kt;if(!n||!r)throw new wt;return{programId:e,keys:{mint:n,rent:r},data:o}}(e);n={name:"initializeMint",accounts:[{name:"tokenMint",...t.keys.mint},{name:"rentSysvar",...t.keys.rent}],args:{decimals:t.data.decimals,mintAuthority:t.data.mintAuthority,freezeAuthority:t.data.freezeAuthority}};break}case w.InitializeAccount:{const t=St(e);n={name:"initializeAccount",accounts:[{name:"newAccount",...t.keys.account},{name:"tokenMint",...t.keys.mint},{name:"owner",...t.keys.owner},{name:"rentSysvar",...t.keys.rent}],args:{}};break}case w.InitializeMultisig:{const t=Bt(e),r=t.keys.signers.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"initializeMultisig",accounts:[{name:"multisig",...t.keys.account},{name:"rentSysvar",...t.keys.rent},...r],args:{m:t.data.m}};break}case w.Transfer:{const t=Pt(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"transfer",accounts:[{name:"source",...t.keys.source},{name:"destination",...t.keys.destination},{name:"owner",...t.keys.owner},...r],args:{amount:new s(t.data.amount.toString())}};break}case w.Approve:{const t=Lt(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"approve",accounts:[{name:"source",...t.keys.account},{name:"delegate",...t.keys.delegate},{name:"owner",...t.keys.owner},...r],args:{amount:new s(t.data.amount.toString())}};break}case w.Revoke:{const t=Rt(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"revoke",accounts:[{name:"source",...t.keys.account},{name:"owner",...t.keys.owner},...r],args:{}};break}case w.SetAuthority:{const t=Ot(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"setAuthority",accounts:[{name:"account",...t.keys.account},{name:"currentAuthority",...t.keys.currentAuthority},...r],args:{authorityType:t.data.authorityType,newAuthority:t.data.newAuthority}};break}case w.MintTo:{const t=_t(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"mintTo",accounts:[{name:"tokenMint",...t.keys.mint},{name:"mintTo",...t.keys.destination},{name:"authority",...t.keys.authority},...r],args:{amount:new s(t.data.amount.toString())}};break}case w.Burn:{const t=$t(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"burn",accounts:[{name:"burnFrom",...t.keys.account},{name:"tokenMint",...t.keys.mint},{name:"owner",...t.keys.owner},...r],args:{amount:new s(t.data.amount.toString())}};break}case w.CloseAccount:{const t=Dt(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"closeAccount",accounts:[{name:"account",...t.keys.account},{name:"destination",...t.keys.destination},{name:"owner",...t.keys.authority},...r],args:{}};break}case w.FreezeAccount:{const t=jt(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"freezeAccount",accounts:[{name:"account",...t.keys.account},{name:"tokenMint",...t.keys.mint},{name:"authority",...t.keys.authority},...r],args:{}};break}case w.ThawAccount:{const t=Vt(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"thawAccount",accounts:[{name:"account",...t.keys.account},{name:"tokenMint",...t.keys.mint},{name:"authority",...t.keys.authority},...r],args:{}};break}case w.TransferChecked:{const t=Jt(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"transferChecked",accounts:[{name:"source",...t.keys.source},{name:"tokenMint",...t.keys.mint},{name:"destination",...t.keys.destination},{name:"owner",...t.keys.owner},...r],args:{amount:new s(t.data.amount.toString()),decimals:t.data.decimals}};break}case w.ApproveChecked:{const t=Zt(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"approveChecked",accounts:[{name:"source",...t.keys.account},{name:"tokenMint",...t.keys.mint},{name:"delegate",...t.keys.delegate},{name:"owner",...t.keys.owner},...r],args:{amount:new s(t.data.amount.toString()),decimals:t.data.decimals}};break}case w.MintToChecked:{const t=Ht(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"mintToChecked",accounts:[{name:"tokenMint",...t.keys.mint},{name:"mintTo",...t.keys.destination},{name:"authority",...t.keys.authority},...r],args:{amount:new s(t.data.amount.toString()),decimals:t.data.decimals}};break}case w.BurnChecked:{const t=Qt(e),r=t.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"burnChecked",accounts:[{name:"burnFrom",...t.keys.account},{name:"tokenMint",...t.keys.mint},{name:"owner",...t.keys.owner},...r],args:{amount:new s(t.data.amount.toString()),decimals:t.data.decimals}};break}case w.InitializeAccount2:{const r=it([ot("instruction"),st(32,"owner")]).decode(e.data);n={name:"initializeAccount2",accounts:[{name:"newAccount",...e.keys[0]},{name:"tokenMint",...e.keys[1]},{name:"rentSysvar",...e.keys[2]}],args:{authority:new t(r.owner)}};break}case w.SyncNative:n={name:"syncNative",accounts:[{name:"account",...e.keys[0]}],args:{}};break;case w.InitializeAccount3:{const r=it([ot("instruction"),st(32,"owner")]).decode(e.data);n={name:"initializeAccount3",accounts:[{name:"newAccount",...e.keys[0]},{name:"tokenMint",...e.keys[1]}],args:{authority:new t(r.owner)}};break}case w.InitializeMultisig2:{const t=e.keys.slice(1).map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"initializeMultisig2",accounts:[{name:"multisig",...e.keys[0]},...t],args:{m:e.data[1]}};break}case w.InitializeMint2:{const t=Et(e);if(!t.keys.mint)throw new Error("Failed to parse InitializeMint2 instruction");n={name:"initializeMint2",accounts:[{name:"tokenMint",...t.keys.mint}],args:{decimals:t.data.decimals,mintAuthority:t.data.mintAuthority,freezeAuthority:t.data.freezeAuthority}};break}default:n=null}return n?{...n,programId:pt}:{programId:pt,name:"unknown",accounts:e.keys,args:{unknown:e.data}}}function he(t){return{name:"createAssociatedTokenAccount",accounts:[{name:"fundingAccount",...t.keys[0]},{name:"newAccount",...t.keys[1]},{name:"wallet",...t.keys[2]},{name:"tokenMint",...t.keys[3]},{name:"systemProgram",...t.keys[4]},{name:"tokenProgram",...t.keys[5]},t.keys.length>5?{name:"rentSysvar",...t.keys[6]}:void 0],args:{},programId:gt}}function de(t,e){return t.map((t=>{const n=t.name;if(Object.prototype.hasOwnProperty.call(t,"accounts")){const r=e?`${e} > ${n}`:n;return de(t.accounts,r)}return{...t,name:e?`${e} > ${n}`:n}})).flat()}class le{constructor(e,r){const o=[[n.programId.toBase58(),ce],[pt.toBase58(),fe],[gt.toBase58(),he]];let i;r=r||[];for(const n of e)r.push(this.buildIdlParser(new t(n.programId),n.idl));if(r){i=new Map(r);for(const t of o)i.has(t[0])||i.set(...t)}else i=new Map(o);this.instructionParsers=i}addParser(t,e){this.instructionParsers.set(t.toBase58(),e)}addParserFromIdl(e,n){this.instructionParsers.set(...this.buildIdlParser(new t(e),n))}buildIdlParser(t,e){return[t.toBase58(),(t=>{const n=new a(e).decode(t.data);if(n){const r=e.instructions.find((t=>t.name===n.name));if(!r)return this.buildUnknownParsedInstruction(t.programId,t.keys,t.data,n.name);const o=de(r.accounts),i=t.keys.map(((t,e)=>e<o.length?{name:o[e].name,...t}:{name:"Remaining "+(e-o.length),...t}));return{name:n.name,accounts:i,programId:t.programId,args:n.data}}return this.buildUnknownParsedInstruction(t.programId,t.keys,t.data)}).bind(this)]}removeParser(t){this.instructionParsers.delete(t.toBase58())}buildUnknownParsedInstruction(t,e,n,r){return{programId:t,accounts:e,args:{unknown:n},name:r||"unknown"}}parseInstruction(t){if(this.instructionParsers.has(t.programId.toBase58())){return this.instructionParsers.get(t.programId.toBase58())(t)}return this.buildUnknownParsedInstruction(t.programId,t.keys,t.data)}parseTransactionWithInnerInstructions(t){return ie(t).map((({parentProgramId:t,...e})=>{const n=this.parseInstruction(e);return t&&(n.parentProgramId=t),n}))}parseTransactionData(t,e){const n=ee(t,e);return t.compiledInstructions.map((t=>this.parseInstruction(ne(t,n))))}parseTransactionParsedData(t){const e=t.accountKeys.map((t=>({isSigner:t.signer,isWritable:t.writable,pubkey:t.pubkey})));return t.instructions.map((t=>this.parseInstruction(oe(t,e))))}parseParsedTransactionWithInnerInstructions(t){const e=se(t),n=t.transaction.message.accountKeys.map((t=>({isSigner:t.signer,isWritable:t.writable,pubkey:t.pubkey})));return e.map((({parentProgramId:t,...e})=>{let r;return r="data"in e?this.parseInstruction(oe(e,n)):this.convertSolanaParsedInstruction(e),t&&(r.parentProgramId=t),r}))}convertSolanaParsedInstruction(t){const e=t.parsed;return{name:e.type,programId:t.programId,info:e.info}}async parseTransaction(t,e,n=!1,r="confirmed"){var o;const i=await t.getTransaction(e,{commitment:r,maxSupportedTransactionVersion:0});if(!i)return null;if(n){return ie(i).map((t=>this.parseInstruction(t)))}return this.parseTransactionData(i.transaction.message,null===(o=i.meta)||void 0===o?void 0:o.loadedAddresses)}parseTransactionDump(t){t instanceof u.Buffer||(t=u.Buffer.from(t,"base64"));const e=r.from(t).compileMessage();return this.parseTransactionData(e)}}export{le as SolanaParser,ne as compiledInstructionToInstruction,se as flattenParsedTransaction,ie as flattenTransactionResponse,te as hexToBuffer,ue as parseLogs,ee as parseTransactionAccounts,oe as parsedInstructionToInstruction};
//# sourceMappingURL=index.js.map
